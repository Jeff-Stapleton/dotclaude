# Story Spec Template

Use this template for every story spec generated by the refinement skill. Fill in all sections. If a section does not apply to this story, write "N/A — {reason}" rather than omitting it.

---

```markdown
# {Story Title}

**Spec ID:** {id}
**Priority:** {P0 / P1 / P2}
**Persona:** {primary persona}
**PRB Requirements:** {requirement IDs}
**Tech Arch Sections:** {section numbers}
**Dependencies:** {story IDs this depends on, or "None"}
**Status:** Draft

---

## Summary

{2-3 sentences: what this story delivers, why it matters to the persona, and what works
after it ships. An implementing agent should read this and immediately understand the scope.}

---

## Phase Scope

{Include this section ONLY if the story spans multiple priorities (e.g., P0 and P1).
If single-priority, delete this section entirely.}

### P0 Scope
- **Requirements:** {IDs}
- **Components:** {component names}
- **Endpoints:** {API endpoints}
- **File Paths:** {paths}

### P1 Scope
- **Requirements:** {IDs}
- **Components:** {component names}
- **Endpoints:** {API endpoints}
- **File Paths:** {paths}

---

## User Stories & Acceptance Criteria

{Copy VERBATIM from the PRB. Do not paraphrase. Include the full user story format
and every acceptance criterion.}

### {Requirement ID}: {Requirement Title}

**User Story:** As a {persona}, I want to {action} so that {outcome}.

**Acceptance Criteria:**
1. {criterion — copied exactly from PRB}
2. {criterion}
3. {criterion}

**Competitive Justification:** {from PRB — which gap or weakness this addresses}

{Repeat for each requirement in this story.}

---

## Technical Approach

### Architecture

{How this story fits into the system architecture. Reference specific sections of the
technical-architecture.md (e.g., "follows the hexagonal architecture from Section 3.1").
Describe the layers involved: UI, API, domain logic, data.}

### Data Model

{Entities this story reads or writes. Reference the ER diagram from the tech arch.
Include relevant fields, relationships, and constraints. Note tenant isolation (RLS)
and audit fields if applicable.}

```
{ASCII or brief description of relevant entity relationships}
```

### API Design

{Endpoints this story requires. Follow the API conventions from the tech arch
(e.g., REST, OpenAPI 3.1, cursor pagination, RFC 7807 errors, JWT auth).}

| Method | Endpoint | Purpose | Auth |
|--------|----------|---------|------|
| GET | /api/v1/{resource} | {purpose} | JWT + {role} |
| POST | /api/v1/{resource} | {purpose} | JWT + {role} |

### UI Components

{Components this story creates or modifies. If Storybook components already exist,
reference them and their states. Include layout, responsive breakpoints, and key
interactions.}

| Component | Location | States | Notes |
|-----------|----------|--------|-------|
| {Name} | {file path} | Default, Loading, Empty, Error | {notes} |

---

## File Paths

{Concrete file paths for everything this story creates or modifies. Every path must
be prefixed with its target repo or project root. An implementing agent must never
have to guess where a file belongs.}

### New Files
- `{repo}/{path}/{file}` — {purpose}
- `{repo}/{path}/{file}` — {purpose}

### Modified Files
- `{repo}/{path}/{file}` — {what changes and why}

---

## Dependencies

### Stories That Must Complete First
{List dependency story IDs with a brief note on what each provides that this story needs.}

- **{story-id}** — provides {what this story needs from it}

### Stories This Unblocks
{List stories that depend on this one.}

- **{story-id}** — needs {what this story provides}

---

## Test Plan

### Unit Tests
- {test description — what it verifies}
- {test description}

### Integration Tests
- {test description — what end-to-end flow it covers}
- {test description}

### Acceptance Tests
{Map directly to the acceptance criteria above. Each AC should have at least one test.}

| AC # | Test | Expected Result |
|------|------|-----------------|
| 1 | {test action} | {expected outcome} |
| 2 | {test action} | {expected outcome} |

---

## Non-Functional Requirements

{Relevant NFRs from the tech arch that apply to this story. Cite NFR IDs.}

| NFR ID | Requirement | How This Story Satisfies It |
|--------|-------------|----------------------------|
| {id} | {requirement} | {implementation approach} |

---

## Architecture Review

Pending review.

## Product Manager Review

Pending review.
```

---

## Template Usage Notes

- **Verbatim PRB content:** The User Stories & Acceptance Criteria section must copy text exactly from the PRB. Do not rephrase, summarize, or "improve" the language.
- **Tech arch references:** Always cite section numbers (e.g., "Section 6.1") rather than restating the content. The implementing agent has access to the full tech arch document.
- **File paths:** Use the project's actual directory conventions. If a repo mapping table exists in the tech arch or CLAUDE.md, follow it.
- **Phase Scope:** Only include this section when requirements span multiple priority levels. When present, each phase subsection must be self-contained — an implementing agent should be able to read only their phase.
- **Review placeholders:** Leave both review sections as "Pending review." — the refinement skill's review phase (Phase 3) or the parent orchestrator will replace these with links to review files.
